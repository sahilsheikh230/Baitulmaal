<% layout("/layouts/boilerplate.ejs") -%>

<div class="container mt-5">
  <h2 class="mb-4 text-success"><i class="fas fa-flag me-2"></i> My Submitted Reports</h2>

  <% if (reports.length === 0) { %>
    <div class="alert alert-info">You have not submitted any reports yet.</div>
  <% } else { %>
    <table class="table table-bordered table-striped">
      <thead class="table-dark">
        <tr>
          <th>#</th>
          <th>Baitulmaal</th>
          <th>Report Message</th>
          <th>Submitted On</th>
          <th>Admin Reply</th>
          <th>Replied On</th>
        </tr>
      </thead>
      <tbody>
        <% reports.forEach((report, index) => { %>
          <tr>
            <td><%= index + 1 %></td>
            <td><%= report.baitulmaal?.name || "N/A" %></td>
            <td><%= report.message %></td>
            <td><%= report.createdAt.toLocaleString() %></td>
            <td>
              <% if (report.adminReply) { %>
                <div class="text-success"><%= report.adminReply %></div>
              <% } else { %>
                <span class="text-muted">No reply yet</span>
              <% } %>
            </td>
            <td>
          <%if( report.adminReply) {%>   <%= report.createdAt ? report.createdAt.toLocaleString() : "-" %><%}%>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  <% } %>

  <a href="/home/donordashboard" class="btn btn-outline-secondary mt-3">
    <i class="fas fa-arrow-left me-1"></i> Back to Dashboard
  </a>
</div>
